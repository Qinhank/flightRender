!(function(t,i,e,a){if(!t){return console.warn("flightRender依赖jQuery或zepto,请确保它们的存在！")}var n=function(i,e){var a=this;if(!i)return;this.$element=i;this.defaults={background:"white",url:"",data:"",index:0,callback:function(){}};this.options=t.extend({},this.defaults,e);this.init()};n.prototype={init:function(){var t=this;t.setStyle();t.callback()},setStyle:function(){this.creatChild();return this.$element.css({background:this.options.background})},creatChild:function(){var t=this;var i=e.createElement("div");var a=e.createElement("ul");var n=e.createElement("ul");i.className="flightRender-title";this.$element.append(i);i.append(a);var l=e.createElement("div");l.className="flightRender-content";this.$element.append(l);l.append(n);t.getData()},getData:function(){var i=this;if(i.options.url!=""){t.ajax({url:this.options.url,dataType:"json",success:function(t){i.flightData=t.data},complete:function(){i.dealData(i.flightData,function(){i.generateCity();i.generateDetail(function(){i.setTags()})})}})}else{i.flightData=i.options.data;i.dealData(i.flightData,function(){i.generateCity();i.generateDetail(function(){i.setTags()})})}},dealData:function(t,i){var e=0,a=[],n=[];for(var l in t){a[e]=l;n[e]=t[l];e+=1}this.flightCityNum=e;this.flightCityArr=a;this.flightDetail=n;if(typeof i=="function"){i()}},generateCity:function(){var i=this;for(var e=0;e<i.flightCityNum;e++){if(e==i.options.index){var a="<li class='active' tagFlight='title'>"+i.flightCityArr[e]+"出发</li>"}else{var a="<li tagFlight='title'>"+i.flightCityArr[e]+"出发</li>"}t(".flightRender-title").find("ul").append(a)}},generateDetail:function(i){var e=this;for(var a=0;a<this.flightCityNum;a++){var n="<li tagFlight='content'><table><tbody class='flightDetailTbody'></tbody></table></li>";var l="<li class='hidden' tagFlight='content'><table><tbody class='flightDetailTbody'></tbody></table></li>";a==e.options.index?t(".flightRender-content").find("ul").append(n):t(".flightRender-content").find("ul").append(l);for(var r in this.flightDetail[a]){var o=this.flightDetail[a][r];d(o,function(){s()})}}i();function s(){var i="<td>"+r+"</td>";var n="<tr>"+i+e._htm+"</tr>";t(".flightRender-content>ul>li").eq(a).find(".flightDetailTbody").append(n)}function d(t,i){for(var a in t){var n="<td>"+a+"</td>";for(var l=0;l<t[a].length;l++){var r=t[a][l];var o="<td>"+r["go"]+" "+r["goTime"]+"<br>"+r["goAirplan"]+"</td>",s="<td>"+r["back"]+" "+r["backTime"]+"<br>"+r["backAirplan"]+"</td>",d="<td>"+r["company"]+"</td>",c="<td>"+r["transit"]+"</td>";e._htm=n+o+s+d+c;i()}}}},setTags:function(){var i=this;t(e).on("click","li[tagFlight='title']",function(){var e=t(this);i.index=e.index();e.siblings("li").removeClass("active");e.addClass("active");var a=t("li[tagFlight='content']").eq(i.index);a.removeClass("hidden");a.siblings("li").addClass("hidden");i.callback()})},callback:function(){var t=this;var i=t.index;if(i==a){i=t.options.index}this.options.callback(i)}};t.fn.flightRender=function(t){var i=new n(this,t)}})(window.jQuery||window.Zepto,window,document);